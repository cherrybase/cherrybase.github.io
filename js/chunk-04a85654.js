(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04a85654"],{"063d":function(t,e,a){},"0fba":function(t,e,a){"use strict";a("6086")},1968:function(t,e,a){"use strict";a("46fb")},"2e30":function(t,e,a){},"2ec9":function(t,e,a){"use strict";a("c554")},"2f21":function(t,e,a){"use strict";var s=a("79e5");t.exports=function(t,e){return!!t&&s((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"2fdb":function(t,e,a){"use strict";var s=a("5ca1"),n=a("d2c8"),i="includes";s(s.P+s.F*a("5147")(i),"String",{includes:function(t){return!!~n(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"328d":function(t,e,a){"use strict";a("a995")},"386b":function(t,e,a){var s=a("5ca1"),n=a("79e5"),i=a("be13"),o=/"/g,r=function(t,e,a,s){var n=String(i(t)),r="<"+e;return""!==a&&(r+=" "+a+'="'+String(s).replace(o,"&quot;")+'"'),r+">"+n+"</"+e+">"};t.exports=function(t,e){var a={};a[t]=e(r),s(s.P+s.F*n((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",a)}},"386d":function(t,e,a){"use strict";var s=a("cb7c"),n=a("83a1"),i=a("5f1b");a("214f")("search",1,(function(t,e,a,o){return[function(a){var s=t(this),n=void 0==a?void 0:a[e];return void 0!==n?n.call(a,s):new RegExp(a)[e](String(s))},function(t){var e=o(a,t,this);if(e.done)return e.value;var r=s(t),c=String(this),l=r.lastIndex;n(l,0)||(r.lastIndex=0);var u=i(r,c);return n(r.lastIndex,l)||(r.lastIndex=l),null===u?-1:u.index}]}))},3902:function(t,e,a){"use strict";a("7f7f");var s=function(){var t=this,e=t._self._c;return t.activeChat?e("div",t._l(t.messages,(function(a){return e("div",{key:"message-".concat(t.activeChat.sessionId,"-").concat(a.messageId,"-").concat(a.messageIdRef),attrs:{id:"message-".concat(t.activeChat.sessionId,"-").concat(a.messageId,"-").concat(a.messageIdRef)}},[a?e("span",[t.$global.MyFunc.isInbound(a.type)?e("div",{staticClass:"d-flex justify-content-start mb-4 chat-bubble",attrs:{title:a.tags?a.tags.categories:null}},[e("div",{staticClass:"msg_cotainer"},[a.replyIdExt||a.replyId?e("div",[e("div",{staticClass:"msg_cotainer_with_reply",attrs:{id:"reply-id-"+a.replyIdExt+"-"+a.messageId},on:{click:function(e){return t.jumpFor(a)},mouseenter:function(e){return t.onReplyShow(a)}}},[t._v("\n                        Reply to  "),e("i",{staticClass:"fa fa-chevron-right"}),e("span",{attrs:{hidden:""}},[t._v(t._s(a.local.replyMessage))])]),e("b-popover",{attrs:{triggers:"hover focus",target:"reply-id-"+a.replyIdExt+"-"+a.messageId,delay:100,"custom-class":"message-preview",placement:"right"},on:{show:function(e){return t.onReplyShow(a)}}},[e("span",{staticClass:"message-preview"},[a.local.replyMessage?e("ChatMessageContent",{attrs:{message:a.local.replyMessage}}):e("span",[t._v("Loading")]),e("loading",{attrs:{active:!a.local.replyMessage,loader:"dots",opacity:.3,"is-full-page":!1}})],1)])],1):t._e(),e("ChatMessageContent",{attrs:{message:a}})],1),e("span",{staticClass:"msg_time"},[e("span",{staticClass:"msg_user"},[t._v(t._s(a.name||"---"))]),t._v("  "+t._s(t._f("formatDate")(a.timestamp))+"\n                "),a.logs||a.stamps?e("span",{staticClass:"msg_status_send-wrapper"},[t._v("\n                     \n                    "),a.stamps.FORWARDED?e("b-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Forwarded @ "+t.$formatters.formatStamp(a.stamps.FORWARDED),expression:"'Forwarded @ ' + $formatters.formatStamp(m.stamps.FORWARDED)"}],staticClass:"msg_status",attrs:{icon:"skip-forward-fill",variant:"dark"}}):t._e()],1):t._e()])]):t.$global.MyFunc.isOutbound(a.type)?e("div",{staticClass:"d-flex justify-content-end mb-4 chat-bubble",attrs:{"data-local-id":"m.localId","data-message-id":a.messageId}},[e("div",{staticClass:"msg_cotainer_send"},[e("ChatMessageContent",{attrs:{message:a}}),e("span",{staticClass:"msg_time_send"},[e("span",[t._v(t._s(t._f("formatDate")(a.timestamp))+"  ")]),e("span",{staticClass:"msg_user"},[t._v(t._s(a.name||"---"))]),e("span",[t._v(" ")]),a.route&&a.route.senderType?e("span",[e("my-icon",{attrs:{type:"senderType",value:a.route.senderType}})],1):t._e(),e("span",[t._v("  ")]),a.logs||a.stamps?e("span",{staticClass:"msg_status_send-wrapper"},[a.messageId?a.stamps.CCWIN?e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Out of customer care window",expression:"`Out of customer care window`"}],staticClass:"fa fa-comment-slash msg_status_send text-danger"}):a.stamps.SENT_ERR?e("b-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.cleanlog(a.logs),expression:"cleanlog(m.logs)"}],staticClass:"msg_status_send",attrs:{icon:"exclamation-triangle",scale:".8",variant:"danger"}}):a.stamps.BLCKD?e("b-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.cleanlog(a.logs),expression:"cleanlog(m.logs)"}],staticClass:"msg_status_send",attrs:{icon:"slash-circle-fill",scale:".8",variant:"danger"}}):a.logs||a.stamps.FAILD||a.stamps.NSENT||a.stamps.SENTX_ERR?e("b-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.cleanlog(a.logs),expression:"cleanlog(m.logs)"}],staticClass:"msg_status_send",attrs:{icon:"exclamation-triangle-fill",scale:".8",variant:"danger"}}):a.stamps.READ?e("b-icon",{staticClass:"msg_status_send",attrs:{icon:"check-all",scale:"1.8",variant:"success"}}):a.stamps.DLVRD?e("b-icon",{staticClass:"msg_status_send",attrs:{icon:"check-all",scale:"1.8",variant:"dark"}}):a.stamps.SENTX?e("b-icon",{staticClass:"msg_status_send",attrs:{icon:"check",scale:"1.8",variant:"dark"}}):a.stamps.SENT?e("b-icon",{staticClass:"msg_status_send muted",attrs:{icon:"check",scale:"1.8",variant:"muted"}}):e("b-icon",{staticClass:"msg_status_send",attrs:{icon:"check",scale:"1.8",variant:"light"}}):e("i",{staticClass:"sending fa fa-spinner fa-spin msg_status_send"},[t._v(" ")])],1):t._e()])],1)]):"A"==a.type||"L"==a.type||"N"==a.type?e("ChatMessageLog",{staticClass:"chat-bubble chat-bubble-note",attrs:{message:a}}):t._e()],1):t._e()])})),0):t._e()},n=[],i=(a("96cf"),a("3b8d")),o=(a("a481"),a("55dd"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex justify-content-center",attrs:{"data-local-id":"m.localId","data-message-id":t.m.messageId}},[t.m.messageId?t._e():e("i",{staticClass:"sending fa fa-spinner fa-spin"},[t._v(" ")]),"N"==t.m.type?e("div",{staticClass:"msg_cotainer_note"},[e("div",{staticClass:"text"},[t._v(t._s(t._f("newlines")(t._f("striphtml")(t.m.text))))]),e("span",{staticClass:"msg_user",class:{"float-right":t.m.sender==t.$global.MyConst.agent}},[t._v(t._s(t._f("blank3dash")(t.m.name)))]),e("span",{class:{"float-right":t.m.name==t.$global.MyConst.agent}},[t._v("\n            "+t._s(t._f("formatDate")(t.m.timestamp))+"  \n        ")])]):e("div",{staticClass:"msg_cotainer_action"},[t._v("\n        "+t._s(t._f("formatDate")(t.m.timestamp))+"  "),e("span",{staticClass:"msg_user"},[t._v(t._s(t._f("blank3dash")(t.m.name)))]),t._v(" "),e("span",{staticClass:"fa fa-long-arrow-alt-right"}),t._v(" "+t._s(t._f("newlines")(t._f("striphtml")(t.m.action)))+"\n        "),t.m.logs?e("span",t._l(t.m.logs,(function(a,s){return e("i",{key:s,staticClass:"prepend-comma"},[t._v("\n             "+t._s(t._f("newlines")(t._f("striphtml")(t._f("log_option")(a,t.m.action)))))])})),0):t._e()])])}),r=[],c={name:"ChatMessageLog",components:{},computed:{m:function(){return this.message}},data:function(){return{}},props:{message:{type:Object}}},l=c,u=(a("a30b"),a("2877")),d=Object(u["a"])(l,o,r,!1,null,"be560cf2",null),p=d.exports,m=function(){var t=this,e=t._self._c;return t.m?e("span",{staticClass:"m-chat-message-content"},["DELTD"==t.m.status?e("span",{staticClass:"text-capitalize text-sm"},[e("span",{staticClass:"fa fa-ban"}),t._v(" "),e("i",[t._v("message deleted ")])]):e("span",[t.m.text?e("span",{directives:[{name:"linkify",rawName:"v-linkify",value:{className:"my-clickable-link"},expression:"{ className: 'my-clickable-link'}"}]},[t._v(t._s(t._f("newlines")(t._f("striphtml")(t.m.text))))]):t._e(),t.m.attachments?e("div",[t.m.template?e("span",[e("span",{staticClass:"bi bi-code-square"}),t._v(" "+t._s(t.m.template))]):t._e(),e("div",{staticClass:"input-group my-attachments"},t._l(t.m.attachments,(function(a,s){return e("span",{directives:[{name:"viewer",rawName:"v-viewer",value:t.viewerOptions,expression:"viewerOptions"}],key:a.mediaURL,staticClass:"my-attachment",class:["mediaType-"+a.mediaType]},["IMAGE"==a.mediaType?e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.$formatters.https_thumburl(a.mediaURL),expression:"$formatters.https_thumburl(atch.mediaURL)"}],attrs:{id:"attachment-".concat(t.m.messageId,"-").concat(s),alt:a.mediaCaption,"data-full-src":t._f("https")(a.mediaURL)}}):"AUDIO"==a.mediaType?e("audio-player",{attrs:{file:a.mediaURL}}):e("a",{staticClass:"my-attachment-link text-center w-100 d-block bg-greyish",attrs:{id:"attachment-".concat(t.m.messageId,"-").concat(s),href:t._f("https")(a.mediaURL),target:"_blank",download:""}},[e("my-icon",{class:[a.mediaMimeType,a.mediaName],attrs:{type:"fileType",value:a.mediaMimeType,status:a.mediaMimeType,meta:a.mediaURL}})],1),a.mediaCaption&&a.mediaCaption!==t.m.text?e("label",{staticClass:"my-attachment-title mediaCaption",attrs:{for:"attachment-".concat(t.m.messageId,"-").concat(s)}},[t._v(t._s(a.mediaCaption))]):a.mediaName?e("label",{staticClass:"my-attachment-title mediaName",attrs:{for:"attachment-".concat(t.m.messageId,"-").concat(s)}},[t._v(t._s(a.mediaName))]):t._e()],1)})),0)]):t.m.vccards&&t.m.vccards.length?e("div",[e("div",{staticClass:"input-group my-attachments"},t._l(t.m.vccards,(function(a,s){return e("span",{key:a.mediaURL,staticClass:"my-attachment mediaType-vccard text-white"},[a.name&&a.name.firstName?e("div",{staticClass:"d-flex"},[e("div",{staticClass:"vccard-icon"},[e("img",{staticClass:"img-responsive img-circle user_img",attrs:{src:t.$global.MyDict.profilePicFun(null,a.name.firstName)}})]),e("div",{staticClass:"text-white vccard-details"},[e("div",{staticClass:"mx-2 my-1 vccard-name"},[t._v(t._s(a.name.firstName)+" "+t._s(a.name.lastName))]),a.phones&&a.phones[0]&&a.phones[0].phone?e("div",{staticClass:"mx-2 fa fa-phone text-center"},[t._v(" "+t._s(a.phones[0].phone))]):t._e(),a.emails&&a.emails[0]&&a.emails[0].email?e("div",{staticClass:"mx-2 fa fa-envelop text-center"},[t._v(" "+t._s(a.emails[0].email))]):t._e()])]):t._e(),a.locations&&a.locations.length?e("div",{},t._l(a.locations,(function(a,s){return e("a",{key:"attachment-".concat(t.m.messageId,"-").concat(s,"-loc"),staticClass:"d-flex",attrs:{target:"_blank",href:"http://maps.google.com/?ie=UTF8&hq=&ll=".concat(a.latitude,",").concat(a.longitude,"&z=18")}},[t._m(0,!0),e("a",{key:"vcard-location"+s,staticClass:"text-white text-sm"},[e("span",{staticClass:"text-white"},[t._v(t._s(a.name))]),e("br"),e("span",{staticClass:"text-white"},[t._v(t._s(a.address))]),e("br")])])})),0):t._e(),e("div",{staticClass:"clearfix"})])})),0)]):t.m.template?e("div",{staticClass:"my-msg-template-tag"},[e("span",{staticClass:"bi bi-code-square"}),t._v(" "+t._s(t.m.template)+"\n        ")]):t._e()])]):t._e()},f=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"vccard-icon"},[e("span",{staticClass:"fas fa-map-marked-alt"})])}],h=a("a026"),v=a("8c57");const g={URL0:/(https?:\/\/[^\s]+)/gim,URL:/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,PSEUDO_URL:/\bwww\.[\S]+\.[\S]+/gim,EMAIL_ADDRESS:/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gim},b={DEFAULT:"_blank"};function _(t=""){return[...t.matchAll(g.EMAIL_ADDRESS),...t.matchAll(g.URL)].flat()}function y(t){if(w(t)){const e=x(t?t.className:null),a=k(t?t.target:null);return`${e} ${a}`}return k()}function C(t,e,a){return null!==e.match(g.EMAIL_ADDRESS)&&(t=S(t,e,a)),null===e.match(g.URL)&&null===e.match(g.PSEUDO_URL)||(t=D(t,e,a)),t}function w(t){return t&&"object"===typeof t&&null!==t&&!Array.isArray(t)}function x(t){return t?`class="${t}"`:""}function k(t){return`target="${t||b.DEFAULT}"`}function S(t,e,a){return t.replace(e,`<a ${a} href="mailto:${e}">${e}</a>`)}function D(t,e,a){const s=-1===e.toLowerCase().indexOf("http")&&-1===e.toLowerCase().indexOf("ftp")?"//":"";return t.replace(e,`<a ${a} href="${s+e.trim()}">${e}</a>`)}function M(t,e){t.innerHTML=t.textContent.split(" ").map(t=>{let a=_(t)||[];if(a.length){const s=y(e);a.forEach(e=>{t=C(t,e,s)})}return t}).join(" ")}const R={bind:function(t,e){M(t,e?e.value:null)},componentUpdated:function(t,e,a){const s=t;s.textContent="",a&&a.children&&a.children[0]&&a.children[0].text&&(s.textContent=a.children[0].text),M(s,e?e.value:null)}};h["default"].use(R);var T={name:"ChatMessageContent",components:{AudioPlayer:v["a"]},directives:{linkify:R},computed:{m:function(t){return this.message}},data:function(){return{viewerOptions:{url:"data-full-src",title:[4,function(t,e){return"".concat(t.alt)}],className:"m-chat-message-content-viewer",navbar:!1}}},props:{message:{type:Object,default:function(){return{text:""}}}}},O=T,I=(a("328d"),a("2ec9"),Object(u["a"])(O,m,f,!1,null,"b8b800dc",null)),$=I.exports,L=a("8760"),j={name:"ChatMessages",components:{ChatMessageLog:p,ChatMessageContent:$},watch:{"$store.getters.StateChatsVersion":function(){this.refreshKey=!this.refreshKey},"$route.params.sessionId":function(t){this.$route.params.jumpTo&&this.jumpTo(this.$route.params.jumpTo)}},computed:{messages:function(){this.refreshKey;var t=this.activeChat.sessionId;return(this.activeChat.messages||[]).filter((function(e){return t==e.sessionId})).sort((function(t,e){return t.timestamp-e.timestamp})).map((function(t){return t.local=t.local||{counter:0},t}))}},data:function(){return{refreshKey:!1,cleanlog:function(t){return(t+"").replace("360dialog","whatsapp")}}},mounted:function(){},methods:{onReplyShow:Object(L["a"])(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.activeChat||!this.activeChat.messages){t.next=10;break}for(a in this.activeChat.messages)(e.replyId&&this.activeChat.messages[a].messageId==e.replyId||e.replyIdExt&&this.activeChat.messages[a].messageIdExt==e.replyIdExt)&&(e.local.replyMessage=this.activeChat.messages[a]);if(e.local.replyMessage){t.next=9;break}return t.next=5,this.$service.get("/api/session/messages",{sessionId:this.activeChat.sessionId,messageId:e.replyId,messageIdExt:e.replyIdExt});case 5:s=t.sent,s.results[0]&&(e.local.replyMessage=s.results[0],this.$forceUpdate()),t.next=10;break;case 9:this.$forceUpdate();case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),500),jumpTo:Object(L["a"])(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$scrollTo(e,{container:".msg_card_body"});case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()),jumpFor:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.onReplyShow(e);case 2:a=this.activeChat.contactId.replace("/","-"),e.local.replyMessage&&(e.local.replyMessage.sessionId==this.activeChat.sessionId?this.jumpTo("#message-".concat(this.activeChat.sessionId,"-").concat(e.local.replyMessage.messageId)):this.$router.push({name:"defAgentView",params:{contactId:a,sessionId:e.local.replyMessage.sessionId,profileId:a,mvu:"CHATBOX",jumpTo:"#message-".concat(e.local.replyMessage.sessionId,"-").concat(e.local.replyMessage.messageId)}}));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},props:{activeChat:{type:Object}}},N=j,A=(a("fddb"),Object(u["a"])(N,s,n,!1,null,"5463b086",null));e["a"]=A.exports},"3e84":function(t,e,a){"use strict";e["a"]={name:"SlideUpDown",props:{active:Boolean,duration:{type:Number,default:500},tag:{type:String,default:"div"},useHidden:{type:Boolean,default:!0}},data:function(){return{style:{},initial:!1,hidden:!1}},watch:{active:function(){this.layout()}},render:function(t){return t(this.tag,{style:this.style,attrs:this.attrs,ref:"container",on:{transitionend:this.onTransitionEnd}},this.$slots.default)},mounted:function(){this.layout(),this.initial=!0},created:function(){this.hidden=!this.active},computed:{el:function(){return this.$refs.container},attrs:function(){var t={"aria-hidden":!this.active,"aria-expanded":this.active};return this.useHidden&&(t.hidden=this.hidden),t}},methods:{layout:function(){var t=this;this.active?(this.hidden=!1,this.$emit("open-start"),this.initial&&this.setHeight("0px",(function(){return t.el.scrollHeight+"px"}))):(this.$emit("close-start"),this.setHeight(this.el.scrollHeight+"px",(function(){return"0px"})))},asap:function(t){this.initial?this.$nextTick(t):t()},setHeight:function(t,e){var a=this;this.style={height:t},this.asap((function(){a.__=a.el.scrollHeight,a.style={height:e(),overflow:"hidden","transition-property":"height","transition-duration":a.duration+"ms"}}))},onTransitionEnd:function(t){t.target===this.el&&(this.active?(this.style={},this.$emit("open-end")):(this.style={height:"0",overflow:"hidden"},this.hidden=!0,this.$emit("close-end")))}}}},"457f":function(t,e,a){"use strict";a.r(e);a("8e6e"),a("ac6a"),a("456d");var s=a("bd86");function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach((function(e){Object(s["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var o=function(){var t=this,e=t._self._c;return e("div",[e("master-view",{attrs:{id:"agent-session-list",header:{heading:t.heading,subheading:t.subheading,icon:t.icon},filters:[{label:"Date Range",name:"daterange"},{label:"Refresh",name:"sync"}],table:i(i({},t.sessions),{},{items:t.filtered}),busy:t.sessions.busy},scopedSlots:t._u([{key:"filter(sync)",fn:function(){return[e("span",{staticClass:"btn btn-success margin-right-5px",on:{click:t.openFilterPopup}},[e("i",{staticClass:"fa fa-filter"})]),e("span",{staticClass:"btn btn-success",on:{click:t.loadSessions}},[e("i",{staticClass:"fa fa-refresh"})])]},proxy:!0},{key:"top-row",fn:function(a){return[e("b-th",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filters.assignedToAgent,expression:"filters.assignedToAgent"}],staticClass:"form-control form-control-sm",attrs:{type:"search"},domProps:{value:t.filters.assignedToAgent},on:{input:function(e){e.target.composing||t.$set(t.filters,"assignedToAgent",e.target.value)}}})]),e("b-th",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filters.contactName,expression:"filters.contactName"}],staticClass:"form-control form-control-sm",attrs:{type:"search"},domProps:{value:t.filters.contactName},on:{input:function(e){e.target.composing||t.$set(t.filters,"contactName",e.target.value)}}})]),e("b-th",[t._v(" ")]),e("b-th",[t._v(" ")]),e("b-th",[e("select",{directives:[{name:"model",rawName:"v-model",value:t.filters.fistResponseStamp,expression:"filters.fistResponseStamp"}],staticClass:"form-control form-control-sm",on:{click:function(t){t.stopPropagation(),t.preventDefault()},change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filters,"fistResponseStamp",e.target.multiple?a:a[0])}}},[e("option",{attrs:{value:""}},[t._v("--")]),t._l(t.fistResponseOptions,(function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t._v(t._s(a.label))])}))],2)]),e("b-th",[e("select",{directives:[{name:"model",rawName:"v-model",value:t.filters.lastSessionStamp,expression:"filters.lastSessionStamp"}],staticClass:"form-control form-control-sm",on:{click:function(t){t.stopPropagation(),t.preventDefault()},change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filters,"lastSessionStamp",e.target.multiple?a:a[0])}}},[e("option",{attrs:{value:""}},[t._v("--")]),t._l(t.closeSessionOptions,(function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t._v(t._s(a.label))])}))],2)])]}},{key:"cell(assignedToAgent)",fn:function(a){return[e("my-icon",{attrs:{type:"chatmode",value:a.item.mode}}),t._v("\n                "+t._s(a.item.assignedToAgent)+"\n                "),a.item.assignedToDept?e("span",[t._v("\n                  ("+t._s(a.item.assignedToDept)+")\n                ")]):t._e(),a.item.assignedToQueue?e("span",[t._v("\n                  | "+t._s(a.item.assignedToQueue)+"\n                ")]):t._e()]}},{key:"cell(contactId)",fn:function(a){return[e("MyText",{staticClass:"mr-2 btn btn-xs btn-outline-grey text-xs text-uppercase",attrs:{options:"getx:/api/options/channels",invalidDisplay:"DEMO",optionLabel:"channelCode"},model:{value:a.item.local.channelId,callback:function(e){t.$set(a.item.local,"channelId",e)},expression:"row.item.local.channelId"}}),e("i",{staticClass:"fab",class:t.MyDict.socialPrefix(a.item.contactType)}),t._v("\n                "+t._s(t._f("contactName")(a.item))+"\n\n                "),e("span",{staticClass:"fa fa-info-circle",attrs:{"cursor-pointer":"",id:"template-details-"+a.index}}),e("b-popover",{attrs:{triggers:"hover focus",target:"template-details-"+a.index,"custom-class":""},scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"message-text text-bold"},[t._v(t._s(a.item.contactName))]),a.item.subject?e("div",{staticClass:"message-text text-bolder"},[t._v(t._s(a.item.subject))]):t._e(),e("div",{staticClass:"message-text text-italic text-xs"},[t._v(t._s(a.item.contactId))]),e("div",{staticClass:"message-text text-italic text-sm"},[t._v(t._s(a.item.sessionId))])]},proxy:!0}],null,!0)})]}},{key:"cell(startSessionStamp)",fn:function(e){return[t._v("\n                "+t._s(t._f("formatDate")(e.item.startSessionStamp))+"\n            ")]}},{key:"cell(fistResponseStamp)",fn:function(e){return[t._v("\n                "+t._s(t._f("formatDate")(e.item.fistResponseStamp))+" \n            ")]}},{key:"cell(lastSessionStamp)",fn:function(a){return[e("span",{staticClass:"fa text-xs",class:{"text-success":a.item.local.open,"text-danger":a.item.local.expired,"text-info":a.item.local.resolved,"fa-dot-circle":a.item.primary,"fa-circle":!a.item.primary}}),t._v("\n                  "+t._s(t._f("formatDate")(a.value))+"\n            ")]}},{key:"cell(actions)",fn:function(a){return[e("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"View Chat",expression:"'View Chat'"}],staticClass:"far fa-comment-alt mg-1 pointer text-primary text-bold",on:{click:function(e){return t.showChat(a.item,a.index,e.target)}}}),t._v("\n                   "),a.item.feedback?e("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:a.item.feedback.tag,expression:"row.item.feedback.tag"}],staticClass:"bi bi-emoji-smile mg-1 pointer text-primary text-bold"},[t._v("\n                    "+t._s(a.item.feedback.score)+"\n                  ")]):t._e()]}},{key:"filter(daterange)",fn:function(){return[e("MyDatePicker",{attrs:{daterange:t.input.daterange},on:{dateRangeOninit:t.dateRangeOnUpdate,dateRangeOnUpdate:t.dateRangeOnUpdate}})]},proxy:!0}])}),e("b-modal",{attrs:{id:t.modelName,title:"Session Filter",size:"lg","hide-footer":""},scopedSlots:t._u([{key:"modal-footer",fn:function(){},proxy:!0}])},[e("div",{staticClass:"filter-wrapper col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"},[e("span",{staticClass:"action-wrapper text-center"},[e("MyDatePicker",{staticClass:"session-search-date-picker date-range-picker-mobile",attrs:{daterange:t.input.daterange,ranges:t.input.dataranges},on:{dateRangeOninit:t.dateRangeOnUpdate,dateRangeOnUpdate:t.dateRangeOnUpdate},scopedSlots:t._u([{key:"input",fn:function(a){return[e("i",{staticClass:"fa fa-calendar-alt"}),t._v(" "+t._s(t._f("date")(a.startDate))+" - "+t._s(t._f("date")(a.endDate))+"\n                ")]}}])})],1),e("br"),e("div",{staticClass:"section-divider"},[e("span",{staticClass:"cat-title section-title"},[t._v("Chat Status")])]),e("div",t._l(t.editableStatus,(function(a,s){return e("span",{key:s,staticClass:"tag-chat-status-lg tag",class:"tag-chat-status-"+s+(-1!=t.selectedStatus.indexOf(s)?" tag-chat-status-active":""),on:{click:function(e){return t.selectStatus(s)}}},[t._v("\n                "+t._s(a.label)+"\n            ")])})),0),t._l(t.sortedQuickTags,(function(a,s){return e("div",{key:s,staticClass:"mt-3"},[e("div",{staticClass:"section-divider"},[e("span",{staticClass:"cat-title section-title"},[t._v(t._s(s))])]),t._l(t.sortedQuickTags[s],(function(a,s){return e("span",{key:s,class:"tag-chat-status-lg tag "+(a.selected?" tag-chat-status-active":""),on:{click:function(e){return t.selectTag(a)}}},[t._v("\n                "+t._s(a.title)+" \n            ")])}))],2)})),e("hr"),e("i",{staticClass:"note",class:t.searchError?"shake-horizontal":""},[t._v("Select a minimum of one filter element to continue")]),e("div",{staticStyle:{"text-align":"center"}},[e("b-button",{staticClass:"btn btn-sm text-black:hover rounded-pill btn-outline-black-dirty",staticStyle:{width:"120px"},on:{click:t.loadSessions}},[t._v(" Search ")])],1),e("hr"),e("i",{staticClass:"note"},[t._v("The search works on the principle of AND / OR operation when elements from multiple categories are selected. AND is applied across different categories and OR is applied within the category")])],2)]),e("div",{staticClass:"chat_archive",class:{closed:!t.session}},[t.session?e("agent-chat",{key:t.session.sessionId,attrs:{session:t.session},on:{close:t.hideChat,update:t.updateChat}}):t._e()],1)],1)},r=[],c=a("75fc"),l=(a("96cf"),a("3b8d")),u=(a("7f7f"),a("6762"),a("2fdb"),a("e492")),d=a("d166"),p=a("df4b"),m=a("6172"),f=(a("c1df"),a("bbf5")),h=a.n(f),v=(a("53b4"),a("3ef3"));var g={components:{PageTitle:u["a"],AgentChat:p["a"],DateRangePicker:h.a},computed:{filtered:function(){var t=this;if(!this.sessions.items.length)return[];var e=this.sessions.items.filter((function(e){return Object.keys(t.filters).every((function(a){var s,n,i,o;if("lastSessionStamp"===a)switch(t.filters[a]){case"resolved":return null===e||void 0===e||null===(s=e.local)||void 0===s?void 0:s.resolved;case"opened":return null===e||void 0===e||null===(n=e.local)||void 0===n?void 0:n.active;case"expired":return null===e||void 0===e||null===(i=e.local)||void 0===i?void 0:i.expired;case"closed":return null===e||void 0===e||null===(o=e.local)||void 0===o?void 0:o.closed;default:return!0}else{if("fistResponseStamp"!==a)return"contactName"===a?String(e._searchText).toLowerCase().includes(t.filters[a].toLowerCase()):String(e[a]).toLowerCase().includes(t.filters[a].toLowerCase());switch(t.filters[a]){case 0:return 0==e[a];case"attended":return 0!=e[a];default:return!0}}}))}));return e.length>0?e:[]},sortedQuickTags:function(){return this.$store.getters.StateQuickTagsSorted},editableStatus:function(){return Object.keys(d["b"].chatStatus).map((function(t){return d["b"].chatStatus[t]})).filter((function(t){return t.editable}))}},filters:{contactName:function(t){var e;return t.contactName||(null===t||void 0===t||null===(e=t.contact)||void 0===e?void 0:e.name)||t.contactId},date:function(t){return t?t.toLocaleDateString():""}},data:function(){return{MyFlags:d["c"],MyDict:d["b"],MyConst:d["a"],heading:"Chat Sessions",subheading:"Select date range for report",icon:"pe-7s-chat icon-gradient bg-tempting-azure fa fa-chalkboard-teacher",sessions:{sortBy:"lastSessionStamp",sortDesc:!0,fields:[{key:"assignedToAgent",label:"Assigned",sortable:!0},{key:"contactId",label:"Contact",sortable:!1},{key:"actions",label:"Action",sortable:!1},{key:"startSessionStamp",label:"Start@",sortable:!0},{key:"fistResponseStamp",label:"Agent@",sortable:!1},{key:"lastSessionStamp",label:"Closed@",sortable:!0,sortByFormatted:!0,formatter:function(t,e,a){return a.closeSessionStamp||a.updatedStamp}}],items:[],perPage:25,currentPage:1,rows:0,busy:!1},closeSessionOptions:[{label:"Closed",value:"closed"},{label:"Expired",value:"expired"},{label:"Resolved",value:"resolved"},{label:"Open",value:"opened"}],fistResponseOptions:[{label:"Attended",value:"attended"},{label:"Not Attended",value:0}],filters:{assignedToAgent:"",contactName:"",lastSessionStamp:"",fistResponseStamp:""},input:{dataranges:["Today","Last 7 Days","Yesterday","This month","Last month"],daterange:{startDate:null,endDate:null,span:"Today"}},session:null,filteron:!0,formatters:v["a"],modelName:"MODAL_FILTER",selectedStatus:[],selectedTag:null,searchError:!1,daterange:{startDate:null,endDate:null,span:"Today"}}},created:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("LoadQuickTags");case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),mounted:function(t){},methods:{openFilterPopup:function(){this.$bvModal.show(this.modelName)},selectTag:function(t){var e=this;this.sortedQuickTags[t.category].map((function(a,s){e.sortedQuickTags[t.category][s].selected=a.id==t.id?!a.selected:a.selected}))},selectStatus:function(t){var e=this.selectedStatus.indexOf(t);-1!=e?this.selectedStatus.splice(e,1):this.selectedStatus=[].concat(Object(c["a"])(this.selectedStatus),[t]),console.log("this.selectedStatus",this.selectedStatus,t,e)},onDateRangeUpdate:function(t){this.daterange&&(this.daterange.startDate=t.startDate,this.daterange.endDate=t.endDate)},loadSessions:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(a in e=[],this.sortedQuickTags)this.sortedQuickTags[a].map((function(t){t.selected&&e.push(t)}));return this.$bvModal.hide(this.modelName),this.sessions.busy=!0,t.prev=4,t.next=7,this.$store.dispatch("GetSessions",{agent:"TEAM",contactType:"MESSAGE_TWITTER",status:this.selectedStatus,tags:e,rangeStamp:this.input.daterange.endDate-this.input.daterange.startDate,startStamp:this.input.daterange.startDate,endStamp:this.input.daterange.endDate});case 7:s=t.sent,this.sessions.items=s.results.map((function(t){return m["a"].session(t)})),this.sessions.rows=this.sessions.items.length,console.log("sessions",s,this.sessions);case 11:return t.prev=11,this.sessions.busy=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[4,,11,14]])})));function e(){return t.apply(this,arguments)}return e}(),dateRangeOnUpdate:function(t){this.input.daterange.startDate=t.startDate,this.input.daterange.endDate=t.endDate,this.loadSessions()},deleteChat:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("DeleteSessionChats",e);case 2:t.sent,this.sessions.items.splice(a,1);case 4:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),hideChat:function(t){this.session=null},showChat:function(t){this.session&&this.session.sessionId==t.sessionId?this.session=null:this.session=t},updateChat:function(t){this.loadSessions()}}},b=g,_=(a("1968"),a("c8b79"),a("a3ac"),a("2877")),y=Object(_["a"])(b,o,r,!1,null,"74cc5b9a",null);e["default"]=y.exports},"46fb":function(t,e,a){},"55dd":function(t,e,a){"use strict";var s=a("5ca1"),n=a("d8e8"),i=a("4bf8"),o=a("79e5"),r=[].sort,c=[1,2,3];s(s.P+s.F*(o((function(){c.sort(void 0)}))||!o((function(){c.sort(null)}))||!a("2f21")(r)),"Array",{sort:function(t){return void 0===t?r.call(i(this)):r.call(i(this),n(t))}})},"58f9":function(t,e,a){},6086:function(t,e,a){},"61d3":function(t,e,a){},6762:function(t,e,a){"use strict";var s=a("5ca1"),n=a("c366")(!0);s(s.P,"Array",{includes:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")},"75fc":function(t,e,a){"use strict";a.d(e,"a",(function(){return v}));var s=a("a745"),n=a.n(s),i=a("db2a");function o(t){if(n()(t))return Object(i["a"])(t)}var r=a("67bb"),c=a.n(r),l=a("5d58"),u=a.n(l),d=a("774e"),p=a.n(d);function m(t){if("undefined"!==typeof c.a&&null!=t[u.a]||null!=t["@@iterator"])return p()(t)}var f=a("e630");function h(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(t){return o(t)||m(t)||Object(f["a"])(t)||h()}},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},8760:function(t,e,a){"use strict";var s=a("b012"),n=a.n(s);const i=function(t,e,a,s){let i,o,r,c;var l=n()((function(){o(t.apply(r,c)),r=c=null,i=null}),e,a,s);let u=function(){return r=this,c=arguments,i=i||new Promise((function(t){o=t})),l(),i};return u.clear=function(t){l.clear(t)},u.flush=function(t){l.flush(t)},u};e["a"]=i},"8b14":function(t,e,a){"use strict";a("2e30")},"8c57":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"player"},[e("div",{staticClass:"player-controls"},[t.stoppable?e("div",{attrs:{id:"stop"}},[e("a",{attrs:{title:"Stop",href:"#"},on:{click:function(e){return e.preventDefault(),t.stop.apply(null,arguments)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:"currentColor",d:"M16,4.995v9.808C16,15.464,15.464,16,14.804,16H4.997C4.446,16,4,15.554,4,15.003V5.196C4,4.536,4.536,4,5.196,4h9.808C15.554,4,16,4.446,16,4.995z"}})])])]):t._e(),e("div",{attrs:{id:"play"}},[e("a",{attrs:{title:t.playing?"Pause":"Play",href:"#"},on:{click:function(e){e.preventDefault(),t.playing=!t.playing}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[t.playing?e("path",{attrs:{fill:"currentColor",d:"M15,3h-2c-0.553,0-1,0.048-1,0.6v12.8c0,0.552,0.447,0.6,1,0.6h2c0.553,0,1-0.048,1-0.6V3.6C16,3.048,15.553,3,15,3z M7,3H5C4.447,3,4,3.048,4,3.6v12.8C4,16.952,4.447,17,5,17h2c0.553,0,1-0.048,1-0.6V3.6C8,3.048,7.553,3,7,3z"}}):e("path",{attrs:{fill:"currentColor",d:"M15,10.001c0,0.299-0.305,0.514-0.305,0.514l-8.561,5.303C5.51,16.227,5,15.924,5,15.149V4.852c0-0.777,0.51-1.078,1.135-0.67l8.561,5.305C14.695,9.487,15,9.702,15,10.001z"}})])])]),e("div",{attrs:{id:"seek"}},[e("div",{staticClass:"player-timeline"},[e("div",{staticClass:"player-progress",style:t.progressStyle}),e("div",{staticClass:"player-seeker",attrs:{title:"Seek"},on:{click:t.seek}})]),e("div",{staticClass:"player-time"},[e("div",{staticClass:"player-time-current"},[t._v(t._s(t._f("convertTimeHHMMSS")(this.currentSeconds)))]),e("div",{staticClass:"player-time-total"},[t._v(t._s(t._f("convertTimeHHMMSS")(this.durationSeconds)))])])]),t.downloading?e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showVolume,expression:"!showVolume"}],attrs:{id:"download"}},[e("a",{attrs:{href:"#",title:"Download"},on:{click:function(e){return e.preventDefault(),t.download.apply(null,arguments)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:"currentColor",d:"M15,7h-3V1H8v6H5l5,5L15,7z M19.338,13.532c-0.21-0.224-1.611-1.723-2.011-2.114C17.062,11.159,16.683,11,16.285,11h-1.757l3.064,2.994h-3.544c-0.102,0-0.194,0.052-0.24,0.133L12.992,16H7.008l-0.816-1.873c-0.046-0.081-0.139-0.133-0.24-0.133H2.408L5.471,11H3.715c-0.397,0-0.776,0.159-1.042,0.418c-0.4,0.392-1.801,1.891-2.011,2.114c-0.489,0.521-0.758,0.936-0.63,1.449l0.561,3.074c0.128,0.514,0.691,0.936,1.252,0.936h16.312c0.561,0,1.124-0.422,1.252-0.936l0.561-3.074C20.096,14.468,19.828,14.053,19.338,13.532z"}})])])]):t._e(),t.loopable?e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showVolume,expression:"!showVolume"}],attrs:{id:"loop"}},[e("a",{attrs:{href:"#",title:"Loop"},on:{click:function(e){e.preventDefault(),t.looping=!t.looping}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[t.looping?e("path",{attrs:{fill:"currentColor",d:"M20,7v7c0,1.103-0.896,2-2,2H2c-1.104,0-2-0.897-2-2V7c0-1.104,0.896-2,2-2h7V3l4,3.5L9,10V8H3v5h14V8h-3V5h4C19.104,5,20,5.896,20,7z"}}):e("path",{attrs:{fill:"currentColor",d:"M1,12V5h3v6h10V8l5,4.5L14,17v-3H3C1.895,14,1,13.104,1,12z"}})])])]):t._e(),t.mutable?e("div",{attrs:{id:"mute"}},[e("a",{attrs:{href:"#",title:"Mute"},on:{click:function(e){return e.preventDefault(),t.mute.apply(null,arguments)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[t.muted?e("path",{attrs:{fill:"currentColor",d:"M14.201,9.194c1.389,1.883,1.818,3.517,1.559,3.777c-0.26,0.258-1.893-0.17-3.778-1.559l-5.526,5.527c4.186,1.838,9.627-2.018,10.605-2.996c0.925-0.922,0.097-3.309-1.856-5.754L14.201,9.194z M8.667,7.941c-1.099-1.658-1.431-3.023-1.194-3.26c0.233-0.234,1.6,0.096,3.257,1.197l1.023-1.025C9.489,3.179,7.358,2.519,6.496,3.384C5.568,4.31,2.048,9.261,3.265,13.341L8.667,7.941z M18.521,1.478c-0.39-0.391-1.023-0.391-1.414,0L1.478,17.108c-0.391,0.391-0.391,1.024,0,1.414c0.391,0.391,1.023,0.391,1.414,0l15.629-15.63C18.912,2.501,18.912,1.868,18.521,1.478z"}}):e("path",{attrs:{fill:"currentColor",d:"M5.312,4.566C4.19,5.685-0.715,12.681,3.523,16.918c4.236,4.238,11.23-0.668,12.354-1.789c1.121-1.119-0.335-4.395-3.252-7.312C9.706,4.898,6.434,3.441,5.312,4.566z M14.576,14.156c-0.332,0.328-2.895-0.457-5.364-2.928C6.745,8.759,5.956,6.195,6.288,5.865c0.328-0.332,2.894,0.457,5.36,2.926C14.119,11.258,14.906,13.824,14.576,14.156zM15.434,5.982l1.904-1.906c0.391-0.391,0.391-1.023,0-1.414c-0.39-0.391-1.023-0.391-1.414,0L14.02,4.568c-0.391,0.391-0.391,1.024,0,1.414C14.41,6.372,15.043,6.372,15.434,5.982z M11.124,3.8c0.483,0.268,1.091,0.095,1.36-0.388l1.087-1.926c0.268-0.483,0.095-1.091-0.388-1.36c-0.482-0.269-1.091-0.095-1.36,0.388L10.736,2.44C10.468,2.924,10.642,3.533,11.124,3.8z M19.872,6.816c-0.267-0.483-0.877-0.657-1.36-0.388l-1.94,1.061c-0.483,0.268-0.657,0.878-0.388,1.36c0.268,0.483,0.877,0.657,1.36,0.388l1.94-1.061C19.967,7.907,20.141,7.299,19.872,6.816z"}})])])]):t._e(),t.volumable?e("div",{attrs:{id:"volume"}},[e("a",{attrs:{title:t.volumeTitle,href:"#"},on:{click:function(t){t.preventDefault()},mouseenter:function(e){t.showVolume=!0},mouseleave:function(e){t.showVolume=!1}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:"currentColor",d:"M19,13.805C19,14.462,18.462,15,17.805,15H1.533c-0.88,0-0.982-0.371-0.229-0.822l16.323-9.055C18.382,4.67,19,5.019,19,5.9V13.805z"}})]),e("input",{directives:[{name:"model",rawName:"v-model.lazy.number",value:t.volume,expression:"volume",modifiers:{lazy:!0,number:!0}},{name:"show",rawName:"v-show",value:t.showVolume,expression:"showVolume"}],staticClass:"player-volume",attrs:{type:"range",min:"0",max:"100"},domProps:{value:t.volume},on:{change:function(e){t.volume=t._n(e.target.value)},blur:function(e){return t.$forceUpdate()}}})])]):t._e()]),e("audio",{ref:"audio",staticStyle:{display:"none"},attrs:{loop:t.looping,src:t.file,preload:"auto"},on:{timeupdate:t.update,loadeddata:t.load,pause:function(e){t.playing=!1},play:function(e){t.playing=!0}}})])},n=[],i=(a("96cf"),a("3b8d")),o={props:{stoppable:{type:Boolean,default:!1},downloading:{type:Boolean,default:!1},autoPlay:{type:Boolean,default:!1},file:{type:String,default:null},loop:{type:Boolean,default:!1},loopable:{type:Boolean,default:!1},mutable:{type:Boolean,default:!1},volumable:{type:Boolean,default:!1}},data:function(){return{currentSeconds:0,durationSeconds:0,loaded:!1,looping:!1,playing:!1,previousVolume:35,showVolume:!1,volume:100}},computed:{muted:function(){return this.volume/100===0},percentComplete:function(){return parseInt(this.currentSeconds/this.durationSeconds*100)},progressStyle:function(){return{width:"".concat(this.percentComplete,"%")}},volumeTitle:function(){return"Volume (".concat(this.volume,"%)")}},filters:{convertTimeHHMMSS:function(t){t=t||0;var e=new Date(1e3*t).toISOString().substr(11,8);return 0===e.indexOf("00:")?e.substr(3):e}},watch:{playing:function(t){if(t)return this.$refs.audio.play();this.$refs.audio.pause()},volume:function(t){this.$refs.audio.volume=this.volume/100}},methods:{download:function(){this.stop(),window.open(this.file,"download")},load:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.$refs.audio){t.next=12;break}if(!(this.$refs.audio.readyState>=2)){t.next=11;break}this.loaded=!0;case 3:if(!this.$refs.audio||this.$refs.audio.duration!==1/0){t.next=9;break}return t.next=6,new Promise((function(t){return setTimeout(t,1e3)}));case 6:this.$refs.audio&&(this.$refs.audio.currentTime=1e7*Math.random()),t.next=3;break;case 9:return this.$refs.audio&&(this.durationSeconds=parseInt(this.$refs.audio.duration),this.$refs.audio.currentTime=0),t.abrupt("return",this.playing=this.autoPlay);case 11:console.error("Failed to load sound file.");case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),mute:function(){if(this.muted)return this.volume=this.previousVolume;this.previousVolume=this.volume,this.volume=0},seek:function(t){if(this.loaded){var e=t.target.getBoundingClientRect(),a=(t.clientX-e.left)/e.width;this.$refs.audio.currentTime=parseInt(this.$refs.audio.duration*a)}},stop:function(){this.playing=!1,this.$refs.audio.currentTime=0},update:function(t){this.currentSeconds=parseInt(this.$refs.audio.currentTime)}},created:function(){this.looping=this.loop}},r=o,c=(a("a4a4"),a("2877")),l=Object(c["a"])(r,s,n,!1,null,"faf42402",null);e["a"]=l.exports},a30b:function(t,e,a){"use strict";a("c7cf")},a3ac:function(t,e,a){"use strict";a("063d")},a4a4:function(t,e,a){"use strict";a("a76f")},a76f:function(t,e,a){},a995:function(t,e,a){},b012:function(t,e){function a(t,e,a){var s,n,i,o,r;function c(){var l=Date.now()-o;l<e&&l>=0?s=setTimeout(c,e-l):(s=null,a||(r=t.apply(i,n),i=n=null))}null==e&&(e=100);var l=function(){i=this,n=arguments,o=Date.now();var l=a&&!s;return s||(s=setTimeout(c,e)),l&&(r=t.apply(i,n),i=n=null),r};return l.clear=function(){s&&(clearTimeout(s),s=null)},l.flush=function(){s&&(r=t.apply(i,n),i=n=null,clearTimeout(s),s=null)},l}a.debounce=a,t.exports=a},b4dd:function(t,e,a){},b54a:function(t,e,a){"use strict";a("386b")("link",(function(t){return function(e){return t(this,"a","href",e)}}))},bb80:function(t,e,a){"use strict";a("b4dd")},c554:function(t,e,a){},c7cf:function(t,e,a){},c8b79:function(t,e,a){"use strict";a("58f9")},df4b:function(t,e,a){"use strict";a("7f7f");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card card-shadow chat_box_wrapper"},[e("div",{staticClass:"card-header msg_head chat-head d-flex justify-content-between"},[e("div",{staticClass:"bd-highlight chat-header-left flex-fill d-flex justify-content-start"},[t.activeChat?e("div",{staticClass:"img_cont",on:{click:function(e){t.MyFlags.showContactProfile=!t.MyFlags.showContactProfile}}},[e("img",{staticClass:"rounded-circle user_img",attrs:{src:t.activeChat.profilePic||t.MyDict.profilePic}}),e("span",{staticClass:"online_icon",attrs:{hidden:""}})]):t._e(),t.activeChat?e("div",{staticClass:"user_info",on:{click:function(e){t.MyFlags.showContactProfile=!t.MyFlags.showContactProfile}}},[e("span",{staticClass:"user_name"},[t._v(t._s(t.activeChat.name))]),t.activeChat.msg&&t.activeChat.msg.lastInBoundMsg?e("div",{staticClass:"user_text text-xs"},[t._v(t._s(t._f("formatDate")(t.activeChat.msg.lastInBoundMsg.timestamp))+" ")]):t._e(),e("div",{staticClass:"user_text text-bold text-elisp"},[t._v(t._s(t.activeChat.subject))])]):t._e()]),e("div",{staticClass:"chat-header-right"},[e("div",{staticClass:"video_cam"},[e("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Close",expression:"'Close'"}],staticStyle:{cursor:"pointer"},on:{click:t.closeBox}},[e("i",{staticClass:"fa fa-close"})])])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showMediaOptions,expression:"!showMediaOptions"}],staticClass:"card-body msg_card_body"},[e("div",{staticClass:"msg_card_body-bubbles"},[e("loading",{attrs:{active:t.isLoading,"can-cancel":!1,loader:"dots",opacity:.3,"is-full-page":!1},on:{"update:active":function(e){t.isLoading=e}}}),t.activeChat?e("ChatMessages",{attrs:{activeChat:t.activeChat}}):e("div",{staticClass:"msg_card_body-logo"},[e("span",{})])],1)]),e("div",{staticClass:"card-footer"},[e("b-row",[e("b-col",{attrs:{cols:"6"}},[t.activeChat.local&&(t.activeChat.local.open||t.activeChat.local.active)?e("span",{staticClass:"btn btn-primary",on:{click:t.closeChat}},[t._v("\n                            Close Chat\n                            ")]):t._e()]),e("b-col",{attrs:{cols:"6"}},[t.activeChat.local&&t.activeChat.local.open?e("BaseVSelect",{staticClass:"text-sm w-100 float-left",attrs:{size:"sm","auto-position":"",options:"getx:/api/options/inbound_queue",optionKey:"code",optionLabel:"code"},on:{change:t.inboundQueueUpdate},model:{value:t.activeChat.assignedToQueue,callback:function(e){t.$set(t.activeChat,"assignedToQueue",e)},expression:"activeChat.assignedToQueue"}}):t._e()],1)],1)],1)])},n=[],i=(a("96cf"),a("3b8d")),o=a("d166"),r=a("9062"),c=a.n(r),l=a("3e84"),u=a("3902"),d=a("6172"),p={components:{Loading:c.a,SlideUpDown:l["a"],ChatMessages:u["a"]},props:{session:Object},computed:{},data:function(){return{message_text:"",quickReplies:null,selectedMedia:null,showMediaOptions:!1,showChatOptions:!1,lastMessageId:null,ilastMessageId:null,MyDict:o["b"],MyFlags:o["c"],MyConst:o["a"],isLoading:!1,showQuickActions:!1,activeChat:{messages:null}}},created:function(){console.log("created")},updated:function(){console.log("updated")},mounted:function(){this.loadMessages(),this.loadQuickLabels()},beforeUnmount:function(){},methods:{loadMessages:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("GetSessionChats..."),this.isLoading=!0,t.next=4,this.$store.dispatch("GetSessionChats",this.session);case 4:e=t.sent,console.log("resp",e),this.activeChat=d["a"].session(e),this.isLoading=!1;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),closeBox:function(t){this.$emit("close")},closeChat:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$service.submit("/api/message/session/close",{sessionId:this.activeChat.sessionId});case 2:this.loadMessages(),this.$emit("update");case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),inboundQueueUpdate:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("this.activeChat.assignedToQueue",this.activeChat.assignedToQueue),t.next=3,this.$service.submit("/api/message/session/route",{sessionId:this.activeChat.sessionId,queue:this.activeChat.assignedToQueue||""});case 3:this.loadMessages(),this.$emit("update");case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadQuickLabels:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("LoadQuickLabels");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},m=p,f=(a("0fba"),a("2877")),h=Object(f["a"])(m,s,n,!1,null,"7a5e0d39",null);e["a"]=h.exports},e492:function(t,e,a){"use strict";a("386d"),a("b54a"),a("7f7f");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-page-title"},[e("div",{staticClass:"page-title-wrapper"},[e("div",{staticClass:"page-title-heading"},[e("div",{staticClass:"page-title-icon"},[e("i",{class:t.icon})]),e("div",[t._v("\n                "+t._s(t.heading)+"\n                "),e("div",{staticClass:"page-title-subheading"},[t._t("subheading",(function(){return[t._v("\n                        "+t._s(t.subheading)+"\n                    ")]}))],2)])]),e("div",{staticClass:"page-title-actions"},[t._l(t.ifFilters,(function(a,s){return e("span",{key:"filter-"+s,staticClass:"filter-wrapper"},[t._t("filter("+a.name+")",(function(){return[a.hidden?t._e():e("span")]}),null,{filter:a})],2)})),t.dateranegeinput&&!t.dateranegeinput.hidden?e("span",{staticClass:"action-wrapper"},[e("date-range-picker",{attrs:{opens:"left","time-picker":!1,"control-container-class":"reportrange-text btn btn-success",ranges:t.dateranegeinput.ranges},on:{select:t.onDateRangeSelect,update:t.onDateRangeUpdate},scopedSlots:t._u([{key:"input",fn:function(a){return[e("i",{staticClass:"fa fa-calendar-alt"}),t._v(" "+t._s(t._f("date")(a.startDate))+" - "+t._s(t._f("date")(a.endDate))+"\n    ")]}}],null,!1,2163278788),model:{value:t.dateranegeinput.range,callback:function(e){t.$set(t.dateranegeinput,"range",e)},expression:"dateranegeinput.range"}})],1):t._e(),t._l(t.actions,(function(a,s){return e("span",{key:"action-"+s,staticClass:"action-wrapper"},[t._t("action("+a.name+")",(function(){return[a.hidden||!1===t.actionShow[a.name]?t._e():e("span",[a.link?e("router-link",{staticClass:"btn-shadow d-inline-flex align-items-center btn",class:{"btn-link":"link"==a.type,"btn-success":!a.type||"button"==a.type},attrs:{tag:"button",to:a.link,type:"button"}},[a.icon?e("i",{staticClass:"mr-2",class:a.icon}):t._e(),t._v("\n                            "+t._s(a.label)+" \n                        ")]):"lane"==a.type?e("div",{staticClass:"d-inline-flex align-items-center",staticStyle:{"min-width":"220px"}},[e("v-select",{staticClass:"w-100",attrs:{options:t.input.lane.options,searchable:!1,clearable:!1,placeholder:"Select Account"},on:{input:function(e){return t.clickAction(a)}},scopedSlots:t._u([{key:"selected-option",fn:function(a){return[e("div",{},[e("span",{staticClass:"contact_type contact_type-24 fab",class:t.MyDict.social[a.contactType]}),t._v("  "+t._s(a.lane))])]}},{key:"open-indicator",fn:function(a){var s=a.attributes;return[e("span",t._b({staticClass:"fa fa-caret-down"},"span",s,!1))]}},{key:"option",fn:function(a){var s=a.contactType,n=a.lane;return[e("span",{staticClass:"contact_type contact_type-24 fab",class:t.MyDict.social[s]}),t._v("  "+t._s(n)+"\n                                ")]}}],null,!0),model:{value:t.input.lane.value,callback:function(e){t.$set(t.input.lane,"value",e)},expression:"input.lane.value"}})],1):"search"==a.type?e("div",{staticClass:"d-inline-flex"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.input.search.value,expression:"input.search.value"}],staticClass:"form-control",attrs:{type:"text",name:""},domProps:{value:t.input.search.value},on:{input:function(e){e.target.composing||t.$set(t.input.search,"value",e.target.value)}}})]):"apply"==a.type?e("div",{staticClass:"d-inline-flex"},[e("button",{staticClass:"btn-shadow align-items-center btn btn-success",on:{click:function(e){return t.clickAction(a)}}},[a.icon?e("i",{class:a.icon}):t._e(),t._v(t._s(a.label))])]):e("div",{staticClass:"d-inline-flex"},[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:a.modal,expression:"action.modal"}],staticClass:"btn-shadow align-items-center btn",class:{"btn-link":"link"==a.type,"btn-success":!a.type||"button"==a.type},on:{click:function(e){return t.clickAction(a)}}},[a.icon?e("i",{staticClass:"mr-2",class:a.icon}):t._e(),t._v("\n                                "+t._s(a.label)+"\n                            ")])],1)],1)]}),null,{action:a})],2)}))],2)]),e("div",{staticStyle:{clear:"both",height:"0px"}})])},n=[],i=(a("96cf"),a("3b8d")),o=a("bbf5"),r=a.n(o),c=(a("53b4"),a("2ead"),a("c1df")),l=a.n(c),u=a("4a7a"),d=a.n(u),p=(a("6dfc"),a("d166"));function m(t){return t.hour(0).minute(0).seconds(0).milliseconds(0)}function f(t){return t.hour(23).minute(59).seconds(59).milliseconds(999)}var h={components:{DateRangePicker:r.a,vSelect:d.a},data:function(){var t=this;return{MyFlags:p["c"],MyDict:p["b"],MyConst:p["a"],dateranegeinput:function(){if(!t.daterange)return null;var e=t.daterange.startDate||m(l()().subtract(7,"day")).toDate(),a=t.daterange.endDate||f(l()()).toDate();return{range:{startDate:e,endDate:a},ranges:{Today:[m(l()()).toDate(),f(l()()).toDate()],"Last 7 Days":[m(l()().subtract(7,"day")).toDate(),f(l()()).toDate()],Yesterday:[m(l()().subtract(1,"day")).toDate(),f(l()().subtract(1,"day")).toDate()],"This month":[m(l()().date(1)).toDate(),f(l()()).toDate()],"Last month":[m(l()().subtract(1,"month").date(1)).toDate(),f(l()().date(0)).toDate()],"This year":[m(l()().month(0).date(1)).toDate(),f(l()()).toDate()],"Last year":[m(l()().subtract(1,"year").month(0).date(1)).toDate(),f(l()().month(0).date(0)).toDate()]}}}(),input:{lane:{options:[],value:null,sender:""},search:{value:null},contacts:""}}},computed:{ifFilters:function(){return this.filters||[]}},filters:{date:function(t){return t?t.toLocaleString():""}},created:function(t){this.daterange&&(this.daterange.startDate||(this.daterange.startDate=m(l()()).toDate()),this.daterange.endDate||(this.daterange.endDate=f(l()()).toDate()),this.sanitizeDateRange(this.daterange)),this.loadLanes()},methods:{sanitizeDateRange:function(t){var e=l()(t.startDate),a=l()(t.endDate);return t.startDate=m(e).toDate(),t.endDate=f(a).toDate(),t},loadLanes:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$service.getX("/api/options/channels");case 2:t.sent,this.input.lane.options=this.$store.getters.StateApi.OptionsChannels;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onDateRangeSelect:function(t){console.log("select",t);var e=this.sanitizeDateRange(t);this.dateranegeinput.range.startDate=e.startDate,this.dateranegeinput.range.endDate=e.endDate},onDateRangeUpdate:function(t){console.log("c_update",t),this.daterange&&(this.daterange.startDate=t.startDate,this.daterange.endDate=t.endDate,this.$emit("dateRangeOnUpdate",t))},clickAction:function(t){this.$emit("action",t)},action:function(t,e,a){for(var s in this.actions)if(this.actions[s].name==t){this.actions[s][e]=a;break}},getInput:function(t){var e;return null===(e=this.input[t])||void 0===e?void 0:e.value}},props:{icon:String,heading:String,subheading:String,actions:Array,filters:Array,daterange:{type:Object,default:function(){return null}},actionShow:{type:Object,default:function(){return{message:"hello"}}}}},v=h,g=(a("8b14"),a("bb80"),a("2877")),b=Object(g["a"])(v,s,n,!1,null,null,null);e["a"]=b.exports},fddb:function(t,e,a){"use strict";a("61d3")}}]);