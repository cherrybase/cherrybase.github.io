(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a38b9"],{"0344":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("b-row",[t("b-col",[t("demo-sender")],1),t("b-col",[t("demo-reciever")],1)],1)],1)},a=[],s=function(){var e=this,t=e._self._c;return t("div",[e.deviceToken?t("b-card",{attrs:{header:"Messages"}},[t("ul",{staticClass:"list-unstyled"},e._l(e.validMessages,(function(n){return t("b-media",{key:n.noteId,staticClass:"m-1",attrs:{tag:"li"},scopedSlots:e._u([{key:"aside",fn:function(){return[t("b-img",{staticClass:"mr-2",attrs:{blank:"","blank-color":"#abc",width:"64",alt:"placeholder"}})]},proxy:!0}],null,!0)},[t("h5",{staticClass:"mt-0 mb-1"},[e._v(e._s(n.otp))]),t("p",{staticClass:"mb-0"},[t("i",{staticClass:"bi bi-stopwatch"}),e._v("\n              "+e._s(n.domain)+" : "+e._s(n.title)+"\n            ")]),t("b-progress",{attrs:{value:n.life,height:"3px",variant:"blue"}})],1)})),1)]):e.otpPrefix&&e.otpNounce?t("b-card",{attrs:{header:"Sign Up - Verify"}},[t("base-input",{key:"signup.otp",attrs:{label:e.otpPrefix,placeholder:"Enter OTP",prelabel:""},scopedSlots:e._u([{key:"append",fn:function(){return[t("span",{attrs:{type:"primary",pointer:""},on:{click:e.login}},[e._v("Verify")])]},proxy:!0}]),model:{value:e.otp,callback:function(t){e.otp=t},expression:"otp"}})],1):t("b-card",{attrs:{header:"Sign Up - Enter Phone"}},[t("base-input",{key:"signup.phone",attrs:{label:"Phone No",prelabel:""},scopedSlots:e._u([{key:"append",fn:function(){return[t("span",{attrs:{type:"primary",pointer:""},on:{click:e.login}},[e._v("Send")])]},proxy:!0}]),model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1),t("b-card",[e.error?t("pre",{staticClass:"text-red"},[e._v(e._s(e.error)+"\n")]):e._e(),t("pre",[e._v("  DeviceId : "+e._s(e.deviceId)+"\n  Phone : "+e._s(e.phone)+"\n  Nounce : "+e._s(e.otpNounce)+"\n  Prefix : "+e._s(e.otpPrefix)+"\n  DeviceToken : "+e._s(e.deviceToken)+"\n      ")])])],1)},o=[],i=n("75fc"),c=(n("96cf"),n("3b8d")),l=n("1675"),p=n("5deb"),u=n("e3ce"),d={data:function(){return{navbarOpen:!1,deviceId:"",phone:"",domain:"",otp:"",title:"",otpPrefix:"",otpNounce:"",deviceToken:"",error:"",messages:[]}},computed:{validMessages:function(){return this.messages.filter((function(e){var t=e.expiredAt.stamp-e.createdAt.stamp,n=e.expiredAt.stamp-Date.now();return e.life=n/t*100,e.life>0}))}},mounted:function(){var e=this;this.$global.Event.fp(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.deviceId=n,t.next=3,e.reloadCreds();case 3:return t.next=5,e.login();case 5:return t.next=7,e.fetchMessage();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},methods:{reloadCreds:function(){var e,t;this.phone=null===(e=this.$store.getters.local)||void 0===e||null===(t=e.notp)||void 0===t?void 0:t.phone,this.deviceToken=this.$service.localStorage.get("deviceToken")},login:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.phone){e.next=2;break}return e.abrupt("return");case 2:return this.$service.store("notp","phone",this.phone),this.error=null,e.prev=4,e.next=7,this.$service.post("/notp/api/v1/login",{deviceId:this.deviceId,phone:this.phone,deviceToken:this.deviceToken,otpNounce:this.otpNounce,otp:this.otp,title:this.title});case 7:t=e.sent,n=t.meta,t.results,console.log("meta==",n),n.otpPrefix&&n.otpNounce?(this.otpPrefix=n.otpPrefix,this.otpNounce=n.otpNounce):n.deviceToken&&(this.$service.localStorage.set("deviceToken",n.deviceToken),this.reloadCreds(),this.fetchMessage()),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](4),this.error="".concat(e.t0.response.data.status," ").concat(e.t0.response.data.statusKey);case 17:case"end":return e.stop()}}),e,this,[[4,14]])})));function t(){return e.apply(this,arguments)}return t}(),fetchMessage:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.reloadCreds(),this.deviceToken){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.$service.post("/notp/api/v1/messages/fetch",{deviceId:this.deviceId,phone:this.phone,deviceToken:this.deviceToken});case 5:t=e.sent,t.meta,n=t.results,this.messages=[].concat(Object(i["a"])(this.messages),Object(i["a"])(n)),setTimeout((function(){return r.fetchMessage()}),300);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},components:{BaseInput:l["default"],BaseButton:p["a"],ProfileApp:u["a"]}},h=d,v=n("2877"),f=Object(v["a"])(h,s,o,!1,null,null,null),b=f.exports,m=function(){var e=this,t=e._self._c;return t("div",[t("b-card",{attrs:{header:"Sender Panel"}},[t("base-input",{attrs:{label:"From",layout:"flushed",prelabel:""},model:{value:e.domain,callback:function(t){e.domain=t},expression:"domain"}}),t("base-input",{attrs:{label:"APIKey",prelabel:""},model:{value:e.apiKey,callback:function(t){e.apiKey=t},expression:"apiKey"}}),t("base-input",{attrs:{label:"To",value:e.phone,readonly:"",prelabel:""},scopedSlots:e._u([{key:"append",fn:function(){return[t("span",{attrs:{type:"primary",pointer:""},on:{click:e.refresh}},[e._v("Refresh")])]},proxy:!0}])}),t("base-input",{attrs:{label:"Title",prelabel:""},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),t("base-input",{attrs:{label:"Validity",prelabel:"",append:"seconds"},model:{value:e.validity,callback:function(t){e.validity=t},expression:"validity"}}),t("base-input",{attrs:{label:"OTP",prelabel:""},scopedSlots:e._u([{key:"append",fn:function(){return[t("span",{attrs:{type:"primary",pointer:""},on:{click:e.send}},[e._v("Send")])]},proxy:!0}]),model:{value:e.otp,callback:function(t){e.otp=t},expression:"otp"}})],1)],1)},k=[],y=n("bd86"),g={data:function(){return Object(y["a"])({domain:"demo",otp:"",title:"Login",apiKey:"*****************",validity:60},"otp",321654)},computed:{phone:function(){var e;return null===(e=this.$store.getters.local.notp)||void 0===e?void 0:e.phone}},mounted:function(){},methods:{send:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$service.post("/notp/api/v1/messages/send",{domain:this.domain,apiKey:this.apiKey,phone:this.phone,otp:this.otp,title:this.title,validity:this.validity});case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),refresh:function(){var e,t;null===(e=this.$store.getters.local)||void 0===e||null===(t=e.notp)||void 0===t||t.phone}},components:{BaseInput:l["default"],BaseButton:p["a"]}},x=g,_=Object(v["a"])(x,m,k,!1,null,null,null),w=_.exports,T={data:function(){return{navbarOpen:!1}},computed:{},methods:{},components:{DemoSender:w,DemoReciever:b}},P=T,O=Object(v["a"])(P,r,a,!1,null,null,null);t["default"]=O.exports}}]);